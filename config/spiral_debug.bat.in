@echo off

REM  Copyright (c) 2018-2021, Carnegie Mellon University
REM  See LICENSE for details

REM This file is generated by CMake and will be overwritten if you re-run make install

set SPIRAL_DIR=%~dp0..\
set GAP_MEM=@SPIRAL_MEMORY_POOL@

IF EXIST "%SPIRAL_DIR%gap\bin\gapd.exe" (
    set GAP_EXE="%SPIRAL_DIR%gap\bin\gapd.exe"
) else (
    set GAP_EXE="%SPIRAL_DIR%gap\bin\gap.exe"
)

if "%~1"=="-B" (
	%GAP_EXE% -B
	goto end
)

if "x%SPIRAL_PROFILER_WORKDIR_PATH%" == "x" (
    set SPIRAL_WORKDIR=%SPIRAL_DIR%profiler
) else (
    set SPIRAL_WORKDIR=%SPIRAL_PROFILER_WORKDIR_PATH%
)

REM  --debug and --keeptemp output debug/trace information and preserve temporary files

if "x%PROFILER_LOCAL_ARGS%" == "x" (
    set PROFILER_LOCAL_ARGS=--debug --keeptemp --workdir %SPIRAL_WORKDIR%
)

set OLDPATH=%PATH%
set PATH=%PATH%;%SPIRAL_DIR%profiler\bin

%GAP_EXE% -m %GAP_MEM% -x 1000 -l "%SPIRAL_DIR%gap\lib" "%SPIRAL_DIR%bin\_spiral_win.g"

set PATH=%OLDPATH%

:end
